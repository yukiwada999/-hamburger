<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ハンバーガー</title>
<style>
  .drag-image {
    position: absolute;
    width: 709px;
    height: 138px;
    border: 2px solid #ccc;
    border-radius: 5px;
    cursor: pointer;
  }
  .right {
  position: absolute;
  left: 700px;
  }
  .btn_reload {
	margin-bottom: 20px;
}

.btn_reload a {
	display: block;
	width: 80%;
	max-width: 260px;
	margin: 0 auto;
	height: 36px;
	line-height: 36px;
	text-align: center;
	background: #01b264;
	color: #fff;
	text-decoration: none;
	border-radius: 5px;
	font-size: 0.875rem;
	transition: .3s ease;
}

.btn_reload a:hover {
	background: #016839;
	transition: .3s ease;
}

.btn_reload a i {
	margin-right: 0.5em;
}
</style>
</head>
<body>
  <!-- 更新ボタン -->
  <a onclick="window.location.reload(true);" class="btn_reload">
    <i class="fa fa-refresh" aria-hidden="true"></i><span>リセット</span>
  </a>
  <!-- 画像表示 -->
  <div class="right">
    <img class="drag-image upPan" src="image/drag_upPan.webp" alt="上バンズ">
  </div>
  <div class="left">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_cabbage.webp" alt="キャベツ">
    <img class="drag-image" src="image/drag_meat.webp" alt="肉">
    <img class="drag-image" src="image/drag_tomato.webp" alt="トマト">
    <img class="drag-image" src="image/drag_downPan.webp" alt="下バンズ">
  </div>

<script>
  // 開始座標を格納する変数
  let startX = 0;
  let startY = 0;

  // ドラッグ中の画像要素を格納する変数
  let draggedElement = null;

  // ドラッグ開始時の処理
  function startDragging(event) {
    // ドラッグ中の画像要素を設定
    draggedElement = event.target;
    // ドラッグ開始時のマウス座標を記録
    startX = event.clientX - draggedElement.offsetLeft;
    startY = event.clientY - draggedElement.offsetTop;
  }

  // ドラッグ中の処理
  function drag(event) {
    // ドラッグ中のマウス座標を取得し、画像要素の位置を更新
    event.preventDefault();
    if (draggedElement) { 
      // draggedElementがnullでない場合のみ処理を行う
      draggedElement.style.left = (event.clientX - startX) + 'px';
      draggedElement.style.top = (event.clientY - startY) + 'px';
    }
  }

  // ドラッグ終了時の処理
  function stopDragging() {
    // ハンバーガーをセットする。
    setHamburger(draggedElement);
    storeDraggedElement = draggedElement;
    // ドラッグ中の画像要素をリセット
    draggedElement = null;
    endDrag(storeDraggedElement)
  }

  // ドラッグ終了後の処理
  function endDrag(element)
  {
    element.removeEventListener('mousedown', startDragging);
  }

  // 画像の位置を取得する関数
  function getImagePosition(image) {
    const position = {
      x: image.offsetLeft,
      y: image.offsetTop
    };
    return position;
  }

  let beforeBurger=null;  // 直前に設置したハンバーガー
  let cnt = 1;  // 何段ハンバーガーを積んだか。

  // ハンバーガーをセットする。
  function setHamburger(setBurger)
  {
    if(beforeBurger!=null) {
      // 直前に積んだバーガーが存在する場合。
      setBurgerPosition = getImagePosition(setBurger);
      beforeBurgerPosition = getImagePosition(beforeBurger);
      // バーガーの位置が半分よりずれているか判定。
      if(setBurgerPosition.x-setBurger.width/2 > beforeBurgerPosition.x ||
         setBurgerPosition.x+setBurger.width/2+setBurger.width < beforeBurgerPosition.x || 
         setBurgerPosition.y+setBurger.height/2+setBurger.height/3 < beforeBurgerPosition.y ||
         setBurgerPosition.y-setBurger.height > beforeBurgerPosition.y) {
          // ずれている場合
          alert('ミス……　乗せた具の枚数：'+cnt+'枚');
          // 全てのドラッグを削除。
          const dragImages = document.querySelectorAll('.drag-image');
          dragImages.forEach(function(image) {
            image.removeEventListener('mousedown', startDragging);
          });

      } else {
        // ずれていない場合
        cnt++;
        // 上バンズを乗せていた場合。
        if(setBurger.classList.contains('upPan')) {
          alert('クリア！！　乗せた具の枚数：'+cnt+'枚');
          // 全てのドラッグを削除。
          const dragImages = document.querySelectorAll('.drag-image');
          dragImages.forEach(function(image) {
            image.removeEventListener('mousedown', startDragging);
          });
        }
      }
    }
    
    beforeBurger = setBurger;
  }

  // 画像要素にドラッグ関連のイベントリスナーを追加
  const dragImages = document.querySelectorAll('.drag-image');
  dragImages.forEach(function(image) {
    image.addEventListener('mousedown', startDragging);
  });
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', stopDragging);
</script>

</body>
</html>
